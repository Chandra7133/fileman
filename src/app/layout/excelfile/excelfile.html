<div class="card mt-4 shadow-sm border-0 rounded-3">
 <div class="card-body">
  <div class="d-flex justify-content-between align-items-center mb-3">
   <h5 class="card-title fw-bold mb-0">Edit EXCEl File</h5>
   <button class="btn btn-outline-secondary" (click)="goback()">🔙 Back</button>
  </div>

  <p><strong>Path:</strong> {{ fullPath }}</p>

  <div class="row g-3 mb-4">
   @for(label of labels;track $index){
   <div class="col-md-3">
    <label class="form-label">{{label | uppercase}}</label>
    <input type="text" class="form-control" [placeholder]="label" [(ngModel)]="record[label]">
   </div>
   }
  </div>

  <button class="btn btn-primary" (click)="isShow = !isShow">
   ➕ Add Column
  </button>

  <div class="text-center mt-3 mb-3">
   <button class="btn btn-success" (click)="save()">{{buttonText}}</button>
   <button class="btn btn-danger" (click)="clear()">Clear</button>
  </div>

  <div style="max-height: 400px; overflow: auto; border: 1px solid #ccc;">
   <table class="table table-bordered table-hover table-striped" style="min-width: max-content;">
    <thead class="table-primary" style="position: sticky; top: 0; z-index: 1; background-color: #cce5ff;">
     <tr>
      @for(label of labels; track $index) {
      <th>{{ label | uppercase }}</th>
      }
      <th>Edit</th>
      <th>Delete</th>
     </tr>
    </thead>
    <tbody>
     @for(data of tableData; track $index) {
     <tr>
      @for(label of labels; track $index) {
      <td>{{ data[label] || "-" }}</td>
      }
      <td><button class="btn btn-sm btn-warning" (click)="edit(data)">✏️</button></td>
      <td><button class="btn btn-sm btn-danger" (click)="del(data)">🗑️</button></td>
     </tr>
     }
     @if(tableData.length == 0) {
     <tr>
      <td [attr.colspan]="labels.length + 2" class="text-center text-muted">No records found.</td>
     </tr>
     }
    </tbody>
   </table>
  </div>

 </div>
</div>

@if(isShow){
<div class="modal-backdrop-blur d-flex justify-content-center align-items-center">
 <div class="bg-white rounded-3 shadow p-4" style="width: 400px;">
  <div class="mb-3 text-center">
   <h5 class="modal-title fw-bold">Add New Column</h5>
  </div>

  <div class="mb-4">
   <input type="text" class="form-control" placeholder="Enter column name" [(ngModel)]="newColumn" />
  </div>

  <div class="d-flex justify-content-center gap-3">
   <button class="btn btn-secondary" (click)="newColumn = '';isShow = false">Cancel</button>
   <button class="btn btn-success" (click)="addColumn()">Add</button>
  </div>
 </div>
</div>
}